
# API Security Checklist (REST/GraphQL/gRPC)

## 1) Идентификация/Аутентификация
- [ ] Клиент/пользователь/сервисные токены разделены, минимальные scope.
- [ ] Ротация токенов/секретов, короткий TTL, PKCE для публичных клиентов.
- [ ] mTLS/подпись запросов где уместно.

## 2) Авторизация/Access Control
- [ ] Объектный уровень (BOLA), ресурсный уровень (RBAC/ABAC).
- [ ] Маскирование полей в ответах (Pii minimization).
- [ ] Rate limiting per user/client/IP/tenant.

## 3) Валидация ввода/схем
- [ ] JSON/XML схемы, строгие типы и границы.
- [ ] Фильтрация/пагинация/сортировка — белые списки полей.
- [ ] GraphQL: depth/complexity лимиты, disable introspection в prod.

## 4) Ошибки/Метаданные
- [ ] Error handling без утечки стеков/конфигов.
- [ ] Версионирование API, deprecation policy.

## 5) Транспорт/Криптография
- [ ] TLS ≥1.2, HSTS (для web шлюзов).
- [ ] Подпись/шифрование payload для чувствительных эндпойнтов.

## 6) CI/CD и секреты
- [ ] Секреты вне репозитория, vault/secret manager.
- [ ] Scan зависимостей и контейнеров, SBOM.

## 7) Логи/Мониторинг
- [ ] Корреляция request-id, audit событий.
- [ ] Алёрты: аномалии, превышение rate, 4XX/5XX всплески.

## 8) Документация/SDK
- [ ] Актуальный OpenAPI/Protobuf.
- [ ] Примеры безопасного использования (минимальные scope).

## Выходные артефакты
- [ ] Сводная таблица эндпойнтов, auth схем, лимитов, обнаруженных рисков и фиксов.
