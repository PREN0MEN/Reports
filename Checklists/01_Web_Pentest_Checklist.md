
# Web Pentest Checklist (OWASP/ASVS/PTES)

> Цель: системно пройти по рискам веб-приложения, собрать доказательства и рекомендации. **Только в согласованном scope.**

## 0) Предварительные данные
- [ ] Scope (домены, пути, роли) подтверждён письменно.
- [ ] Доступы для теста (аккаунты разных ролей) выданы.
- [ ] Тестовые данные согласованы, защита PII учтена.
- [ ] Точки входа: web, API, OAuth/OIDC, SSO, внешние провайдеры.

## 1) Аутентификация (ASVS V2)
- [ ] Регистрация/вход: блокировки брутфорса, MFA опционально/обязательно.
- [ ] Пароли: политика длины, ротация при необходимости, проверка на утечки (HIBP).
- [ ] Сброс пароля: одноразовые токены, срок жизни, безопасность каналов.
- [ ] SSO/OAuth/OIDC: корректная валидация redirect_uri, PKCE, scopes.
- [ ] Сессии: Secure/HttpOnly, SameSite, срок жизни, ре-логин для крит. действий.
- **Артефакты**: скрин форм входа, cookie-флаги, сетевые трассы, логика восстановления доступа.

## 2) Авторизация / Контроль доступа (ASVS V4, V1)
- [ ] **IDOR**: доступ к чужим ресурсам по изменению идентификатора.
- [ ] **Vertical/Horizontal**: доступ между ролями и пользователями.
- [ ] Маскировка/фильтрация полей по ролям, защита админ-эндпойнтов.
- **Артефакты**: таблица ролей и доступов, примеры запрос/ответ, доказательство запрета/разрешения.

## 3) Ввод/вывод и XSS/Injection (ASVS V5/V6/V10)
- [ ] XSS: Reflected/Stored/DOM (валидация, контекстная экранизация).
- [ ] SQL/NoSQL/LDAP/Command Injection: подготовленные выражения, ORM, валидация.
- [ ] Template/SSRF/XXE: ограничения схем/доменов, безопасные парсеры.
- **Артефакты**: безопасные/небезопасные payload-примеры, контекст вывода, места недостаточной валидации.

## 4) Бизнес-логика
- [ ] Обход шагов (multi-step), гонки (race conditions), повтор запросов (replay).
- [ ] Лимиты (квоты, rate limiting), денежные/скидочные механики.
- [ ] Подтверждения критических операций (re-auth, 4-eye, OTP).
- **Артефакты**: диаграмма потоков, сценарии злоупотреблений, доказательства ограничения/его отсутствия.

## 5) Файлы/Загрузки
- [ ] Типы и размер, серверная валидация, хранение вне webroot.
- [ ] Трансформации (EXIF/Office макросы), конвертация медиа.
- [ ] Генерация ссылок (время жизни, одноразовость, подписанные URL).
- **Артефакты**: примеры допустимых/заблокированных файлов, заголовки ответа, место хранения.

## 6) Секреты/Конфигурации
- [ ] Секреты в коде/конфиге/JS? публичные ключи/токены?
- [ ] Debug/verbose: stack traces, описание исключений.
- [ ] Headers: CSP, HSTS, X-Frame-Options, Referrer-Policy.
- **Артефакты**: список секретов/ключей в фронте, полный набор security headers.

## 7) Криптография/Транспорт (ASVS V9, V13)
- [ ] TLS: версии/шифры/сертификаты, HSTS preloading при необходимости.
- [ ] Хеши/шифрование PII/паролей (bcrypt/argon2), ключевой менеджмент.
- **Артефакты**: результаты проверки TLS, образцы хранения PII/паролей (только метаданные).

## 8) Клиент/SPA/Мобильный веб
- [ ] Маршрутизация/guard’ы на клиенте не заменяют серверные проверки.
- [ ] Local/session storage: отсутствие чувствительных токенов.
- **Артефакты**: map хранилищ, где и что лежит.

## 9) Логи/Аудит/Алёрты
- [ ] Аудит критических операций (вход, сброс пароля, роль).
- [ ] Без PII/секретов в логах, защита от лог-инъекций.
- **Артефакты**: примеры логов, ретеншн, алёрты на злоупотребления.

## 10) Рекомендации/Приоритизация
- [ ] Таблица: уязвимость → риск → фиксы → владелец → срок.
- [ ] Быстрые фиксы (конфиг) отдельно, долгие (код) отдельно.
- **Выход**: консолидированный отчёт с приложением PoC и бизнес-риском.
